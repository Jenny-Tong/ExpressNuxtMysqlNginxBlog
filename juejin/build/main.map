{"version":3,"sources":["webpack:///webpack/bootstrap c4f78ffdde0620b10db2","webpack:///external \"express\"","webpack:///./server/lib/util.date.js","webpack:///./node_modules/.6.26.0@babel-runtime/regenerator/index.js","webpack:///./server/lib/sql.js","webpack:///./config/index.js","webpack:///./server/middlewares/check.js","webpack:///external \"marked\"","webpack:///./server/models/comments.js","webpack:///./config/development.js","webpack:///external \"sha1\"","webpack:///./server/models/users.js","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///./server/index.js","webpack:///(webpack)/buildin/harmony-module.js","webpack:///external \"nuxt\"","webpack:///external \"express-session\"","webpack:///external \"express-mysql-session\"","webpack:///external \"winston\"","webpack:///external \"express-winston\"","webpack:///./server/api/index.js","webpack:///./server/api/posts.js","webpack:///./server/models/posts.js","webpack:///external \"regenerator-runtime\"","webpack:///external \"mysql\"","webpack:///./config/default.js","webpack:///./config/production.js","webpack:///external \"xss\"","webpack:///./util/assist.js","webpack:///./server/api/signin.js","webpack:///./server/api/signout.js","webpack:///./server/api/signup.js","webpack:///external \"buffer\"","webpack:///external \"multer\"","webpack:///./nuxt.config.js","webpack:///./package.json","webpack:///external \"axios\"","webpack:///external \"body-parser\"","webpack:///external \"cookie-parser\""],"names":["exports","formatDate","dateFromDateStr","getToday","monthOffset","now","Date","setHours","setMinutes","setSeconds","setMilliseconds","pad","val","len","String","length","weeks","offset","dateOffset","realDate","getTime","dateStr","parse","replace","endDate","startDate","endArr","split","startArr","date","returnType","fixOffset","zone","getTimezoneOffset","month","getMonth","year","getFullYear","day","getDate","week","getDay","ar","str","join","str1","sub","today","tomorrow","weekday","hour","getHours","getMinutes","min","sec","getSeconds","monthDay","yearMonthDay","dateShort","dateShort1","dateShort2","str2","shortTightTime","tightTime","shortTime","time","dateStr1","tightDate","mysql","require","config","getConfig","pool","createPool","dbConfig","mysqlQuery","args","Promise","resolve","reject","getConnection","err","connection","result","query","fields","release","e","name","module","checkLogin","req","res","next","checkNotLogin","marked","contentToHtml","posts","map","post","content","create","comment","dateMap","addSql","addSqlParams","JSON","stringify","author","postId","commentRes","modSql","delCommentById","commentId","sql","getComments","cb","forEach","item","index","proConfig","devEnv","port","apiPort","apiHost","sslModel","uploadPath","disConfig","Object","assign","param","password","gender","bio","avatar","created_at","addRet","insertId","getUserByName","session","MySQLStore","winston","expressWinston","nuxtConfig","path","pkg","fs","app","express","use","bodyParser","json","cookieParser","host","process","env","HOST","PORT","set","__dirname","key","secret","cookie","maxAge","secure","store","connectionLimit","expiration","resave","saveUninitialized","locals","blog","title","description","logger","transports","File","filename","startRouter","errorLogger","Console","colorize","on","writeSync","reason","p","console","log","warning","warn","message","stack","nuxt","builder","build","render","parent","listen","get","redirect","router","Router","xss","authorId","pageIndex","PostModel","getPosts","then","catch","error","user","body","Error","pv","params","all","getPostById","CommentModel","incPv","comments","mdContent","_id","getRawPostById","toString","updatePostById","flash","delPostById","pageSize","commentsCount","data","modSqlParams","values","delRes","devConfig","database","timestamp","getYear","postToSQLUpdate","object","updated","hasOwnProperty","push","deepCopy","timeAgo","between","Number","pluralize","getCookiesInServer","Cookies","headers","Cookie","parts","trim","setCookieInClient","value","minutes","exp","setTime","document","escape","toGMTString","getCookieInClient","arr","reg","RegExp","match","unescape","baidutongji","_hmt","hm","createElement","src","s","getElementsByTagName","parentNode","insertBefore","mobilePage","sha1","UserModel","code","multer","upload","getUploadPath","single","repassword","newPath","file","type","mimetype","writeFile","buffer","indexOf","unlink","sqlMessage","head","script","meta","charset","hid","link","rel","href","css","lang","vendor","loading","transition","middleware","plugins","ssr","serverMiddleware"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c4f78ffdde0620b10db2","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","exports.formatDate = formatDate;\nexports.dateFromDateStr = dateFromDateStr;\nexports.getToday = getToday;\nexports.monthOffset = monthOffset;\n\nfunction getToday() {\n    var now = new Date();\n    now.setHours(0);\n    now.setMinutes(0);\n    now.setSeconds(0);\n    now.setMilliseconds(0);\n    return now;\n}\n\nfunction pad(val, len) {\n    val = String(val);\n    len = len || 2;\n    while (val.length < len) val = \"0\" + val;\n    return val;\n}\n\nvar weeks = [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"],\n    offset = 0;\n\nfunction dateOffset(realDate) {\n    offset = (new Date()).getTime() - realDate.getTime();\n}\n//yyyy-MM-dd HH:mm:ss  支持缩短  支持/\nfunction dateFromDateStr(dateStr) {\n    return new Date(Date.parse(dateStr.replace(/-/g, \"/\")));\n}\n\n//有效期，出行日期\n//data1,date2都是yyyy-MM-dd格式的时间字符串\nfunction monthOffset(endDate, startDate) {\n    var endArr = endDate.split('-');\n    var startArr = startDate.split('-');\n    if (!endArr || !endArr.length || !startArr || !startArr.length) {\n        return null;\n    }\n    var offset = (endArr[0] - startArr[0]) * 12 + (endArr[1] - startArr[1]);\n    if (endArr[2] - startArr[2] < 0) {\n        offset -= 1;\n    }\n    return offset;\n}\n\nfunction formatDate(date, returnType, fixOffset) {\n    date = date || new Date();\n    if (fixOffset) {\n        //For the real date\n        if (offset)\n            date = new Date(date.getTime() - offset);\n        //Set timezone for china.\n        var zone = -date.getTimezoneOffset() / 60;\n        if (zone != 8)\n            date = new Date(date.getTime() + (8 - zone) * 60 * 60 * 1000);\n    }\n    if (returnType == \"date\") {\n        return date;\n    }\n    var month = date.getMonth() + 1,\n        year = date.getFullYear(),\n        day = date.getDate(),\n        week = date.getDay(),\n        ar = [year, pad(month), pad(day)],\n        str = ar.join(\"-\");\n\n    if (!returnType)\n        return str;\n\n    var str1 = ar.join(\"\");\n\n    if (returnType == \"humanize\") {\n        var sub = \" 周\" + weeks[week];\n        var today = new Date();\n        if (year == today.getFullYear() && month == (today.getMonth() + 1) && day == today.getDate()) {\n            sub = \" 今天\";\n        }\n        var tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);\n        if (year == tomorrow.getFullYear() && month == (tomorrow.getMonth() + 1) && day == tomorrow.getDate()) {\n            sub = \" 明天\";\n        }\n        return (month + \"月\" + day + \"日\" + sub);\n    }\n    if (returnType == \"humanizeFull\") {\n        var sub = \" 周\" + weeks[week];\n        var today = new Date();\n        if (year == today.getFullYear() && month == (today.getMonth() + 1) && day == today.getDate()) {\n            sub = \" 今天\";\n        }\n        var tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);\n        if (year == tomorrow.getFullYear() && month == (tomorrow.getMonth() + 1) && day == tomorrow.getDate()) {\n            sub = \" 明天\";\n        }\n        return (year + \"年\" + month + \"月\" + day + \"日\" + sub);\n    }\n\n    if (returnType == \"weekday\") {\n        var sub = \" 周\" + weeks[week];\n        var today = new Date();\n        if (year == today.getFullYear() && month == (today.getMonth() + 1) && day == today.getDate()) {\n            sub = \" 今天\";\n        }\n        var tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);\n        if (year == tomorrow.getFullYear() && month == (tomorrow.getMonth() + 1) && day == tomorrow.getDate()) {\n            sub = \" 明天\";\n        }\n        return {\n            day: month + \"月\" + day + \"日\",\n            weekday: sub,\n        }\n    }\n\n    if (returnType == \"dayWeekDayHourMinite\") {\n        var sub = \" 周\" + weeks[week];\n        var today = new Date();\n        if (year == today.getFullYear() && month == (today.getMonth() + 1) && day == today.getDate()) {\n            sub = \" 今天\";\n        }\n        var tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);\n        if (year == tomorrow.getFullYear() && month == (tomorrow.getMonth() + 1) && day == tomorrow.getDate()) {\n            sub = \" 明天\";\n        }\n        return {\n            day: pad(month) + \"-\" + pad(day),\n            weekday: sub,\n            hour: pad(date.getHours()) + \":\" + pad(date.getMinutes()),\n        }\n    }\n\n    //05-30\n    if (returnType == \"Month-Day\") {\n        return month + \"-\" + day;\n    }\n\n    if (returnType == \"Year-Month-Day\") {\n        return year + \"-\" + month + \"-\" + day;\n    }\n\n    if (returnType == \"tight\") {\n        return str1;\n    }\n\n\n    var hour = date.getHours(),\n        min = date.getMinutes(),\n        sec = date.getSeconds();\n\n    if (returnType == \"tightFull\") {\n        return str1 + pad(hour) + pad(min) + pad(sec);\n    }\n\n    if (returnType == \"hour\") {\n        return pad(hour);\n    }\n\n    if (returnType == \"time\") {\n        return pad(hour) + \":\" + pad(min) + \":\" + pad(sec);\n    }\n\n    if (returnType == \"datetime\") {\n        return str + \" \" + pad(hour) + \":\" + pad(min) + \":\" + pad(sec);\n    }\n\n    //19:00\n    if (returnType == \"hour:sec\") {\n        return pad(hour) + \":\" + pad(min);\n    }\n\n    if (returnType == \"typeDictionary\") {\n        var sub = \" 周\" + weeks[week];\n        var today = new Date();\n        if (year == today.getFullYear() && month == (today.getMonth() + 1) && day == today.getDate()) {\n            sub = \" 今天\";\n        }\n        var tomorrow = new Date(today.getTime() + 24 * 60 * 60 * 1000);\n        if (year == tomorrow.getFullYear() && month == (tomorrow.getMonth() + 1) && day == tomorrow.getDate()) {\n            sub = \" 明天\";\n        }\n        var monthDay = month + \"月\" + day + \"日\",\n            yearMonthDay = year + \"年\" + monthDay,\n            dateShort = month + \"-\" + day,\n            dateShort1 = month + \"/\" + day,\n            dateShort2 = pad(month) + \"-\" + pad(day),\n            str2 = ar.join(\"/\"),\n            shortTightTime = pad(hour) + pad(min),\n            tightTime = shortTightTime + pad(sec),\n            shortTime = pad(hour) + \":\" + pad(min),\n            time = shortTime + \":\" + pad(sec);\n        return {\n            monthDay: monthDay, // MM月dd日\n            yearMonthDay: yearMonthDay, // yyyy年MM月dd日\n            weekday: sub, // 今天/明天/周x\n            dateStr: str, // yyyy-MM-dd\n            dateStr1: str2, // yyyy/MM/dd\n            dateShort: dateShort, // MM-dd\n            dateShort1: dateShort1, // MM/dd\n            dateShort2: dateShort2, // MM-dd  补零\n            tightDate: str1, // yyyyMMdd\n            shortTightTime: shortTightTime, // hhmm\n            tightTime: tightTime, // hhmmss\n            shortTime: shortTime, // hh:mm\n            time: time // hh:mm:ss\n        }\n    }\n\n    return str;\n}\n\n\n// WEBPACK FOOTER //\n// ./server/lib/util.date.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/.6.26.0@babel-runtime/regenerator/index.js\n// module id = 2\n// module chunks = 0","let mysql = require('mysql');\nimport getConfig from '../../config';\nlet config = getConfig(process.env.NODE_ENV);\n\n\nlet pool = mysql.createPool(config.dbConfig);\n/**\n * sql, SqlParams  参数只可能是一个或者两个\n * @return {[type]} [description]\n */\n\nexport  function mysqlQuery(...args) {\n    return new Promise((resolve, reject) => {\n        try {\n            pool.getConnection(function(err, connection) {\n                if (err) {\n                    reject({ err: err, result: \"failure\" });\n                } else {\n                    connection.query(...args, function(err, result, fields) {\n                        if (err) {\n                            reject({ err, result });\n                        } else {\n                            resolve({ err, result });\n                        }\n                        connection.release();\n                    });\n                }\n\n            });\n        } catch (e) {\n            reject({ err: e, result: \"failure\" });\n        } finally {\n\n        }\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./server/lib/sql.js","import development from './development.js'\nimport production from './production.js'\n\nexport default function getConfig(name=\"production\") {\n    if (name=='production') {\n        return production;\n    } else {\n        return development;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./config/index.js","module.exports = {\n\tcheckLogin:function(req,res,next) {\n\t\t// console.log(\"=======耶耶耶=======\",req.session.user);\n\t\t// if (!req.session.user) {\n\t\t// \t//req.flash('error','未登录');\n\t\t// \treturn res.redirect('/signin');\n\t\t// }\n\t\tnext();\n\t},\n\tcheckNotLogin:function(req,res,next){\n\t\t// if (req.session.user) {\n\t\t// \t//req.flash('error','已登录');\n\t\t// \treturn res.redirect('back');//返回之前的页面\n\t\t// }\n\t\tnext();\n\t}\n};\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/middlewares/check.js","module.exports = require(\"marked\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"marked\"\n// module id = 6\n// module chunks = 0","/*\n * @Author: huangchengdu\n * @Date:   2017-01-14 14:17:43\n * @Last Modified by:   huangchengdu\n * @Last Modified time: 2017-01-14 14:18:22\n */\n\nlet marked = require('marked');\nlet mysqlQuery = require('../lib/sql').mysqlQuery;\nlet formatDate = require('../lib/util.date').formatDate;\n\nfunction contentToHtml(posts) {\n    return posts.map(function(post) {\n        post.content = marked(post.content);\n        return post;\n    });\n}\n\nexport default  {\n    // 创建一个留言\n    async create(comment) {\n        const dateMap = formatDate(new Date(), 'typeDictionary');\n        const date = dateMap.yearMonthDay + \" \" + dateMap.time;\n        let addSql = 'INSERT INTO comments(author,content,postId,created_at) VALUES(?,?,?,?)';\n        let addSqlParams = [JSON.stringify(comment.author), comment.content, comment.postId, date];\n        let commentRes = await mysqlQuery(addSql, addSqlParams);\n        if (commentRes.err) {\n            Promise.reject(commentRes.err);\n        } else {\n            let modSql = 'UPDATE posts SET commentsCount = commentsCount + 1 where _id=' + comment.postId;\n            let { err, result } = await mysqlQuery(modSql);\n            if (err) {\n                Promise.reject(err);\n            } else {\n                Promise.resolve(commentRes.result);\n            }\n        }\n    },\n    // 通过用户 id 和留言 id 删除一个留言\n    async delCommentById(commentId, postId) {\n        let sql = 'DELETE FROM comments where _id=' + commentId;\n        let commentRes = await mysqlQuery(sql);\n        if (commentRes.err) {\n            Promise.reject(commentRes.err);\n        } else {\n            let modSql = 'UPDATE posts SET commentsCount = commentsCount - 1 where _id=' + postId;\n            let { err, result } = await mysqlQuery(modSql);\n            if (err) {\n                Promise.reject(err);\n            } else {\n                Promise.resolve(commentRes.result);\n            }\n        }\n    },\n    // 通过文章 id 获取该文章下所有留言，按留言创建时间升序\n    async getComments(postId, cb) {\n        let sql = 'SELECT * FROM comments where postId=' + postId + \" ORDER BY _id desc\";\n        let { err, result } = await mysqlQuery(sql);\n        try {\n            result = contentToHtml(result);\n            result.forEach(function(item, index) {\n                item.author = JSON.parse(item.author);\n            });\n        } catch (e) {\n            err = e;\n        } finally {\n            if (err) {\n                return Promise.reject(err);\n            } else {\n                return Promise.resolve(result);\n            }\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./server/models/comments.js","// let devConfig = require('./default.js');\nimport {default as devConfig} from './default.js';\n\nlet proConfig = {\n    devEnv: true,\n    port: 5389,\n    apiPort:5389,\n    apiHost:\"http://127.0.0.1\",\n    sslModel: false,\n    uploadPath:'/../../static/img/'\n}\nlet disConfig = Object.assign({}, devConfig, proConfig);\n\nexport default disConfig;\n\n\n// WEBPACK FOOTER //\n// ./config/development.js","module.exports = require(\"sha1\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sha1\"\n// module id = 9\n// module chunks = 0","/*\n * @Author: huangchengdu\n * @Date:   2017-01-14 11:16:16\n * @Last Modified by:   huangchengdu\n * @Last Modified time: 2017-01-14 12:11:11\n */\n\nlet mysqlQuery = require('../lib/sql').mysqlQuery;\nlet formatDate = require('../lib/util.date').formatDate;\n\nexport default {\n    // 注册一个用户\n    async create(param) {\n        let addSql = 'INSERT INTO users(name,password,gender,bio,avatar,created_at) VALUES(?,?,?,?,?,?)';\n        let addSqlParams = [param.name, param.password, param.gender, param.bio, param.avatar, param.created_at];\n        let addRet = await mysqlQuery(addSql, addSqlParams);\n        if (addRet.result && addRet.result.insertId) {\n            let sql = 'SELECT * FROM users where _id=' + addRet.result.insertId;\n            let { err, result } = await mysqlQuery(sql);\n            if (err) {\n                return Promise.reject(err);\n            } else {\n                return Promise.resolve(result[0]);\n            }\n        } else {\n            return Promise.reject(addRet.err);\n        }\n    },\n    // 通过用户名获取用户信息\n    async getUserByName(name) {\n        let sql = 'SELECT * FROM users where name=\"' + name + '\"';\n        let { err, result } = await mysqlQuery(sql);\n        if (err) {\n            return Promise.reject(err);\n        } else {\n            return Promise.resolve(result[0]);\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./server/models/users.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 12\n// module chunks = 0","import {\n    Nuxt,\n    Builder\n} from 'nuxt'\nimport express from 'express'\nvar session = require('express-session');\nvar MySQLStore = require('express-mysql-session')(session);\nvar winston = require('winston');\nvar expressWinston = require('express-winston');\nimport {\n    startRouter\n} from './api/index'\nlet nuxtConfig = require('../nuxt.config.js');\nimport getConfig from '../config';\nvar path = require('path');\nvar pkg = require('../package');\nlet config = getConfig(process.env.NODE_ENV);\nvar fs = require('fs');\nimport axios from 'axios';\nimport bodyParser from 'body-parser'\nimport cookieParser from 'cookie-parser'\n\n\nconst app = express();\n\napp.use(bodyParser.json());\napp.use(cookieParser());\n\n// process.env.DEBUG = 'nuxt:*'\n\n\nconst host = process.env.HOST || '127.0.0.1';\nconst port = process.env.PORT || config.port;\n\n// console.log(\"===========dirname\",__dirname);\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\n\n// session 中间件\napp.use(session({\n    key: config.session.key,\n    secret: config.session.secret,\n    cookie: {\n        maxAge: config.session.maxAge,\n        secure: true\n    },\n    store: new MySQLStore(config.dbConfig),\n    connectionLimit: 100,\n    expiration: 86400000,\n    resave: true,\n    saveUninitialized: true\n}));\n\napp.locals.blog = {\n    title: pkg.name,\n    description: pkg.description\n};\n\n// 使用上的区别在于：app.locals 上通常挂载常量信息（如博客名、描述、作者信息），res.locals 上通常挂载变量信息，即每次请求可能的值都不一样（如请求者信息，res.locals.user = req.session.user）。\n// app.use(function (req, res, next) {\n//   // res.locals.user = req.session.user;\n//   // res.locals.success = req.flash('success').toString();\n//   // res.locals.error = req.flash('error').toString();\n//   next();\n// });\n\napp.use(expressWinston.logger({\n    transports: [\n        // new(winston.transports.Console)({\n        //   json: true,\n        //   colorize: true\n        // }),\n        new winston.transports.File({\n            filename: 'server/logs/success.log'\n        })\n    ]\n}));\n\nstartRouter(app);\n\napp.use(expressWinston.errorLogger({\n    transports: [\n        new winston.transports.Console({\n            json: true,\n            colorize: true\n        }),\n        new winston.transports.File({\n            filename: 'server/logs/error.log'\n        })\n    ]\n}));\n\n// error page\n// app.use(function (err, req, res, next) {\n// \tres.render('error', {\n// \t\terror: err\n// \t});\n// });\n\nprocess.on('uncaughtException', (err) => {\n    fs.writeSync(1, `Caught exception: ${err}\\n`);\n});\n//promise错误未处理\nprocess.on('unhandledRejection', (reason, p) => {\n    console.log('未处理的==========================Rejection at:', p, 'reason:', reason);\n});\n//系统警告\nprocess.on('warning', (warning) => {\n    console.warn(warning.name); // Print the warning name\n    console.warn(warning.message); // Print the warning message\n    console.warn(warning.stack); // Print the stack trace\n});\n\nlet nuxt = new Nuxt(nuxtConfig);\nif (config.devEnv) {\n    const builder = new Builder(nuxt);\n    builder.build();\n}\n// Add nuxt.js middleware\napp.use(nuxt.render);\n\nif (module.parent) {\n    module.exports = app;\n} else {\n    // Listen the server\n    app.listen(port, host, function () {\n        console.log('Server listening on http://' + host + ':' + port); // eslint-disable-line no-console\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = function(originalModule) {\r\n\tif(!originalModule.webpackPolyfill) {\r\n\t\tvar module = Object.create(originalModule);\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"exports\", {\r\n\t\t\tenumerable: true,\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/harmony-module.js\n// module id = 14\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"express-mysql-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-mysql-session\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"winston\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"express-winston\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-winston\"\n// module id = 19\n// module chunks = 0","import PostModule from './posts.js';\nimport SigninModule from './signin.js';\nimport SignoutModule from './signout.js';\nimport SignupModule from './signup.js';\n\nexport function startRouter(app) {\n        app.get('/', function(req, res) {\n            res.redirect('/posts');\n        });\n        app.use('/api/posts', PostModule);\n        app.use('/api/login', SigninModule);\n        app.use('/api/signup', SignupModule);\n        app.use('/api/signout', SignoutModule);\n    }\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","let express = require('express');\nlet router = express.Router();\nimport PostModel from '../models/posts';\nvar xss = require('xss');\nimport {\n    postToSQLUpdate\n} from '../../util/assist';\nimport CommentModel from '../models/comments';\nlet checkLogin = require('../middlewares/check').checkLogin;\n\n//GET /posts 所有用户或者特定用户的文章页\n// eg: GET /posts?author=xxx\nrouter.get('/', function (req, res, next) {\n    let authorId = req.query && req.query.author;\n    let pageIndex = req.query && req.query.pageIndex;\n    PostModel.getPosts(authorId, pageIndex).then(posts => {\n        res.json(posts);\n    }).catch(error => {\n        res.json(error)\n    });\n});\n// POST /posts 发表一篇文章\nrouter.post('/create', checkLogin, function (req, res, next) {\n    let author = req.session.user;\n    let title = req.body.title;\n    let content = req.body.content;\n    try {\n        if (!title.length) {\n            throw new Error('请填写标题');\n        }\n        if (!content.length) {\n            throw new Error('请填写内容');\n        }\n    } catch (e) {\n        res.json({\n            err: {\n                message: e.message || \"发布失败\"\n            },\n            post: null\n        });\n    }\n    let post = {\n        author: author,\n        title: title,\n        content: content,\n        pv: 0\n    };\n    PostModel.create(post).then(post => {\n        res.json({\n            err: null,\n            post: post\n        });\n    }).catch(e => {\n        res.json({\n            err: {\n                message: e.message || \"添加出错\"\n            },\n            post: null\n        });\n    });\n});\n\n// GET /posts/:postId 单独一篇的文章页\nrouter.get('/:postId', function (req, res, next) {\n    let postId = req.params.postId;\n    Promise.all([\n        PostModel.getPostById(postId), //获取文章\n        CommentModel.getComments(postId), //获取评论\n        PostModel.incPv(postId) //添加访问次数\n    ]).then(result => {\n        let post = result[0];\n        let comments = result[1];\n        post.content = post.content.replace(\"<script>\", \"script\");\n        post.content = post.content.replace(\"<iframe>\", \"iframe\");\n        res.render('index', {\n            mdContent: post.content\n        }, function (err, result) {\n            post.content = result;\n            res.json({\n                post,\n                comments\n            });\n        });\n    }).catch(error => {\n        res.json(error)\n    });\n});\n\n// GET /posts/:postId/edit 更新文章页\nrouter.get('/:postId/edit', checkLogin, function (req, res, next) {\n    let postId = req.params.postId;\n    let author = req.session.user._id;\n\n    PostModel.getRawPostById(postId)\n        .then(function (post) {\n            if (!post) {\n                throw new Error('该文章不存在');\n            }\n            if (author.toString() !== post.author._id.toString()) {\n                throw new Error('权限不足');\n            }\n            res.render('edit', {\n                post: post\n            });\n        })\n        .catch(next);\n});\n\n// POST /posts/:postId/edit 更新一篇文章\nrouter.post('/:postId/edit', checkLogin, function (req, res, next) {\n    let postId = req.params.postId;\n    let author = req.session.user;\n    let title = req.fields.title;\n    let content = req.fields.content;\n\n    PostModel.updatePostById({\n        title: title,\n        content: content,\n        author: JSON.stringify(author),\n        postId: postId\n    }).then(result => {\n        req.flash('success', '编辑文章成功');\n        // 编辑成功后跳转到上一页\n        res.redirect(`/posts/${postId}`);\n    }).catch(next);\n});\n\n// GET /posts/:postId/remove 删除一篇文章\nrouter.get('/:postId/remove', checkLogin, function (req, res, next) {\n    let postId = req.params.postId;\n    PostModel.delPostById(postId)\n        .then(function () {\n            req.flash('success', '删除文章成功');\n            // 删除成功后跳转到主页\n            res.redirect('/posts');\n        })\n        .catch(next);\n});\n\n// POST /posts/:postId/comment 创建一条留言\nrouter.post('/:postId/comment', checkLogin, function (req, res, next) {\n    let author = req.session.user;\n    let postId = req.params.postId;\n    let content = req.body.content;\n    let comment = {\n        author: author,\n        postId: postId, //文章id\n        content: content\n    };\n    CommentModel.create(comment)\n        .then(result => {\n            CommentModel.getComments(postId).then(result => {\n                res.json({\n                    err: null,\n                    comments: result\n                });\n            }).catch(err => {\n                res.json({\n                    err: {\n                        message: \"获取评论失败\"\n                    },\n                    comments: null\n                });\n            });\n        }).catch(err => {\n            res.json({\n                err: {\n                    message: \"添加评论失败\"\n                },\n                comments: null\n            });\n        });\n});\n\n// GET /posts/:postId/comment/:commentId/remove 删除一条留言\nrouter.get('/:postId/comment/:commentId/remove', checkLogin, function (req, res, next) {\n    let commentId = req.params.commentId;\n    let postId = req.params.postId;\n    CommentModel.delCommentById(commentId, postId)\n        .then(result => {\n            req.flash('success', '删除留言成功');\n            // 删除成功后跳转到上一页\n            res.redirect('back');\n        })\n        .catch(next);\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/posts.js","let marked = require('marked');\nlet CommentModel = require('./comments');\n// let mysqlQuery = require('../lib/sql').mysqlQuery;\nimport {mysqlQuery} from '../lib/sql.js';\nlet formatDate = require('../lib/util.date').formatDate;\n\n\nfunction contentToHtml(posts) {\n    return posts.map(function(post) {\n        post.content = marked(post.content);\n        return post;\n    });\n}\n\nexport default {\n    // 创建一篇文章\n    async create(post) {\n        const dateMap = formatDate(new Date(), 'typeDictionary');\n        const date = dateMap.yearMonthDay + \" \" + dateMap.time;\n\n        let addSql = 'INSERT INTO posts(author,title,content,pv,created_at,commentsCount,authorId) VALUES(?,?,?,?,?,?,?)';\n        let addSqlParams = [JSON.stringify(post.author), post.title, post.content, '0', date, '0', post.author._id];\n        let addRet = await mysqlQuery(addSql, addSqlParams);\n        if (!addRet.err && addRet.result.insertId) {\n            let sql = 'SELECT * FROM posts where _id=' + addRet.result.insertId;\n            let { err, result } = await mysqlQuery(sql);\n            try {\n                result = result[0];\n                result.author = JSON.parse(result.author);\n                result.content = marked(result.content);\n            } catch (e) {\n                err = e;\n            } finally {\n                if (err) {\n                    return Promise.reject(err);\n                } else {\n                    return Promise.resolve(result);\n                }\n            }\n        } else {\n            return Promise.reject(err);\n        }\n    },\n    // 通过文章 id 获取一篇文章\n    async getPostById(postId) {\n        const sql = 'SELECT * FROM posts where _id=' + postId;\n        let { err, result } = await mysqlQuery(sql);\n        try {\n            result = result[0];\n            result.author = JSON.parse(result.author);\n            result.content = marked(result.content);\n        } catch (e) {\n            err = e;\n        } finally {\n            if (err) {\n                return Promise.reject(err);\n            } else {\n                return Promise.resolve(result);\n            }\n        }\n    },\n    // 按创建时间降序获取所有用户文章或者某个特定用户的所有文章\n    async getPosts(authorId,pageIndex) {\n        var pageSize = 10;\n        let sql = 'SELECT author,_id,pv,title,authorId,created_at,commentsCount FROM posts';\n        if (authorId) {\n            sql = sql + \" where authorId=\" + authorId;\n        }else{\n            sql = sql + ` LIMIT ${pageIndex * pageSize},${pageSize}`\n        }\n        let { err, result } = await mysqlQuery(sql);\n        try {\n            //result = contentToHtml(result);\n            //var resResult = [];\n            result = result.map(function(item, index) {\n                item.author = JSON.parse(item.author);\n                return {\n                    author:item.author,\n                    _id:item._id,\n                    pv:item.pv,\n                    title:item.title,\n                    authorId:item.authorId,\n                    created_at:item.created_at,\n                    commentsCount:item.commentsCount\n                }\n            });\n        } catch (e) {\n            err = e;\n        } finally {\n            if (err) {\n                return Promise.reject(err);\n            } else {\n                return Promise.resolve(result);\n            }\n        }\n    },\n    // 通过文章 id 给 pv 加 1\n    async incPv(postId) {\n        let sql = 'UPDATE posts SET pv = pv + 1 where _id=' + postId;\n        let { err, result } = await mysqlQuery(sql);\n        if (err) {\n            return Promise.reject(err);\n        } else {\n            return Promise.resolve(result);\n        }\n    },\n    // 通过文章 id 获取一篇原生文章（编辑文章）\n    getRawPostById(postId) {\n        return this.getPostById(postId);\n    },\n    // 通过用户 id 和文章 id 更新一篇文章\n    async updatePostById(data) {\n        let modSql = 'UPDATE posts SET title = ?,content = ?,author = ? WHERE _id = ?';\n        let modSqlParams = Object.values(data);\n        let { err, result } = await mysqlQuery(modSql, modSqlParams);\n        if (err) {\n            return Promise.reject(err);\n        } else {\n            return Promise.resolve(result);\n        }\n    },\n    // 通过用户 id 和文章 id 删除一篇文章\n    async delPostById(postId) {\n        let sql = 'DELETE FROM posts where _id=' + postId;\n        let delRes = await mysqlQuery(sql);\n        if (delRes.err) {\n            return Promise.reject(delRes.err);\n        } else {\n            sql = 'DELETE FROM comments where postId=' + postId;\n            let { err, result } = await mysqlQuery(sql);\n            if (err) {\n                return Promise.reject(err);\n            } else {\n                return Promise.resolve(result);\n            }\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./server/models/posts.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"mysql\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mysql\"\n// module id = 24\n// module chunks = 0","/*\n * @Author: huangchengdu\n * @Date:   2017-01-13 16:19:01\n * @Last Modified by:   huangchengdu\n * @Last Modified time: 2017-01-16 11:00:33\n */\n\nlet devConfig = {\n    port: 443,\n    sslModel: false,\n    session: {\n        secret: 'session',\n        key: 'session',\n        maxAge: 1000 * 60 * 1500\n    },\n    dbConfig: {\n        connectionLimit: 30,\n        host: '47.96.6.227',\n        user: 'huang303513',\n        password: 'huang303513',\n        port: '3306',\n        database: 'myblog'\n    },\n    devEnv: true\n};\n\nexport default devConfig;\n\n//这两个文件必须写成comment.js规范。引用他们的第三方库只支持这个规范。\n\n\n// WEBPACK FOOTER //\n// ./config/default.js","/*\n * @Author: huangchengdu\n * @Date:   2017-01-14 18:47:32\n * @Last Modified by:   huangchengdu\n * @Last Modified time: 2017-01-15 08:18:01\n */\n\n// let devConfig = require('./default.js');\nimport {default as devConfig} from './development.js';\n\nlet proConfig = {\n    devEnv: false,\n    port: 5389,//如果package.json里面不一样，以这里为准\n    apiPort:443,\n    apiHost:\"https://www.huangchengdu.com\",\n    sslModel: false,\n    uploadPath:'/usr/local/webserver/nginx/static/img/'\n}\nlet disConfig = Object.assign({}, devConfig, proConfig);\n\nexport default disConfig;\n\n\n// WEBPACK FOOTER //\n// ./config/production.js","module.exports = require(\"xss\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"xss\"\n// module id = 27\n// module chunks = 0","\nexport function formatDate(timestamp) {\n  let date = new Date(timestamp);\n  return date.getYear() + \"-\" + date.getMonth() + 1 + \"-\" + date.getDate() + \"   \" + date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\n}\n/**\n * 把一个js对象转换为sql操作字符串\n * @param {*} object \n */\nexport function postToSQLUpdate(object) {\n  let updated = [], params = [];\n  for (var key in object) {\n    if (object.hasOwnProperty(key)) {\n      if (key === 'id') {\n        continue;\n      }\n      updated.push(key + ' = ?')\n      params.push(object[key])\n    }\n  }\n  updated.push('updated_at = ?')\n  params.push(Date.now())\n  return {\n    updated: updated.join(','),\n    params: params\n  }\n}\n\nexport function deepCopy(object) {\n  return JSON.parse(JSON.stringify(object))\n}\n\nexport function timeAgo(time) {\n  const between = Date.now() / 1000 - Number(time)\n\n  if (between < 3600) {\n    return pluralize(~~(between / 60), ' 分钟前')\n  } else if (between < 86400) {\n    return pluralize(~~(between / 3600), ' 小时前')\n  } else {\n    return pluralize(~~(between / 86400), ' 天前')\n  }\n}\n/**\n * 在服务端获取cookie\n * @param {获取request的cookie} req \n */\nexport function getCookiesInServer(req) {\n  let Cookies = {};\n  req && req.headers.cookie && req.headers.cookie.split(';').forEach(function (Cookie) {\n    let parts = Cookie.split('=');\n    Cookies[parts[0].trim()] = (parts[1] || '').trim();\n  });\n  return Cookies;\n}\n/**\n * 在客户端设置cookie\n * @param {*} name \n * @param {*} value \n * @param {*} minutes \n */\nexport function setCookieInClient(name, value, minutes) {\n  let exp = new Date();\n  exp.setTime(exp.getTime() + minutes * 60 * 1000);\n  document.cookie = name + \"=\" + escape(value) + \";expires=\" + exp.toGMTString();\n}\n\n/**\n * 获取浏览器端指定的cookie\n * @param {*} name \n */\nexport function getCookieInClient(name) {\n  let arr, reg = new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\");\n  if (arr = document.cookie.match(reg))\n    return unescape(arr[2]);\n  else\n    return null;\n}\n\n/**\n * 百度统计脚本\n */\nexport function baidutongji() {\n  var _hmt = _hmt || [];\n  (function() {\n    var hm = document.createElement(\"script\");\n    hm.src = \"https://hm.baidu.com/hm.js?96b0d09e8d132a6e61f66ea86b479b70\";\n    var s = document.getElementsByTagName(\"script\")[0]; \n    s.parentNode.insertBefore(hm, s);\n  })();\n\n\n}\n/**\n * 适配移动端屏幕\n */\nexport function mobilePage() {\n  (function() {\n    var hm = document.createElement(\"script\");\n    hm.src = \"https://www.huangchengdu.com/javascripts/screen.js\";\n    var s = document.getElementsByTagName(\"script\")[0]; \n    s.parentNode.insertBefore(hm, s);\n  })();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./util/assist.js","/*\n * @Author: huangchengdu\n * @Date:   2017-01-13 21:54:40\n * @Last Modified by:   huangchengdu\n * @Last Modified time: 2017-01-14 12:14:32\n */\n\nlet sha1 = require('sha1');\nlet express = require('express');\nlet router = express.Router();\nimport UserModel from '../models/users';\nlet checkNotLogin = require('../middlewares/check').checkNotLogin;\n\n// POST /signin 用户登录\nrouter.post('/', function (req, res, next) {\n    let name = req.body.name;\n    let password = req.body.password;\n    UserModel.getUserByName(name).then(user => {\n        var err;\n        if (!user) {\n            err = {\n                message: \"用户名或者密码错误\"\n            }\n        } else if (sha1(password) !== user.password) {\n            err = {\n                message: \"用户名或者密码错误\"\n            }\n        }\n        req.session.user = user; \n        res.json({\n            err: err,\n            user: user\n        });\n    }).catch(next);\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/signin.js","/*\n* @Author: huangchengdu\n* @Date:   2017-01-13 21:56:39\n* @Last Modified by:   huangchengdu\n* @Last Modified time: 2017-01-14 11:51:43\n*/\n\nlet express = require('express');\nlet router = express.Router();\n\n// GET /signout 登出\nrouter.get('/', function(req, res, next) {\n  req.session.user = null;\n  res.json({err:null,code:200});\n});\n\nexport default router;\n\n\n// WEBPACK FOOTER //\n// ./server/api/signout.js","/*\n * @Author: huangchengdu\n * @Date:   2017-01-13 21:55:28\n * @Last Modified by:   huangchengdu\n * @Last Modified time: 2017-01-14 11:22:20\n */\n\n// let express = require('express');\n// let router = express.Router();\n\n// let checkNotLogin = require('../middlewares/check').checkNotLogin;\n\n// // GET /signup 注册页\n// router.get('/', checkNotLogin, function(req, res, next) {\n//   res.render('signup');\n// });\n\n// // POST /signup 用户注册\n// router.post('/', checkNotLogin, function(req, res, next) {\n//   res.send(req.flash());\n// });\n\n// module.exports = router;\n\nlet fs = require('fs');\nlet path = require('path');\nlet sha1 = require('sha1');\nlet express = require('express');\nlet router = express.Router();\nimport UserModel from '../models/users';\nimport {Buffer} from 'buffer';\nlet checkNotLogin = require('../middlewares/check').checkNotLogin;\nlet formatDate = require('../lib/util.date').formatDate;\nvar multer = require('multer')\nvar upload = multer();\nimport getConfig from '../../config';\nlet config = getConfig(process.env.NODE_ENV);\n\nfunction getUploadPath(avatar) {\n    if (config.devEnv) {\n        return path.join(__dirname,config.uploadPath,avatar);\n    } else {\n        return config.uploadPath + avatar;\n    }\n}\n\n// POST /signup 用户注册\nrouter.post('/', upload.single('avatar'), function (req, res, next) {\n    let name;\n    let gender;\n    let bio;\n    let password;\n    let repassword;\n    let newPath;\n    try {\n        var timestamp = Date.now();\n        if (!req.file) {\n            throw new Error('请添加图片');\n        }\n        var type = req.file.mimetype.split('/')[1];\n        var avatar = timestamp + \".\" + type;\n        newPath = getUploadPath(avatar);\n        console.log(newPath);\n        fs.writeFile(newPath, req.file.buffer, function (err) {\n            if (err) {\n                throw new Error('上传照片失败');\n            }\n        });\n\n        name = req.body.name;\n        gender = req.body.gender;\n        bio = req.body.bio;\n        password = req.body.password;\n        repassword = req.body.repassword;\n        if (!(name.length >= 1 && name.length <= 20)) {\n            throw new Error('名字请限制在 1-10 个字符');\n        }\n        if (['m', 'f', 'x'].indexOf(gender) === -1) {\n            throw new Error('性别只能是 m、f 或 x');\n        }\n        if (!(bio.length >= 1 && bio.length <= 30)) {\n            throw new Error('个人简介请限制在 1-30 个字符');\n        }\n        if (password.length < 6) {\n            throw new Error('密码至少 6 个字符');\n        }\n        if (password !== repassword) {\n            throw new Error('两次输入密码不一致');\n        }\n    } catch (e) {\n        // 注册失败，异步删除上传的头像\n        fs.unlink(newPath);\n        res.json({\n            err: {message:e.message||\"校验出错\"},\n            user: null\n        });\n    }\n    // 明文密码加密\n    password = sha1(password);\n\n    const dateMap = formatDate(new Date(), 'typeDictionary');\n    const date = dateMap.yearMonthDay + \" \" + dateMap.time;\n    // 待写入数据库的用户信息\n    let user = {\n        name: name,\n        password: password,\n        gender: gender,\n        bio: bio,\n        avatar: avatar || \"\",\n        created_at: date\n    };\n\n    UserModel.create(user).then(user => {\n        req.session.user = user;\n        res.json({\n            err: null,\n            user: user\n        });\n    }).catch(err => {\n        fs.unlink(newPath);\n        if (err.err) {\n            err = err.err;\n        }\n        if (err && err.sql) {\n            err.sql = \"\";\n        }\n        // 用户名被占用则跳回注册页，而不是错误页\n        if (err.sqlMessage && (err.sqlMessage.indexOf('Duplicate entry') >= 0)) {\n            res.json({\n                err: {message: \"用户名被占用\"},\n                user: null\n            });\n        } else {\n            res.json({err: err,user: null});\n        }\n    });\n});\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/signup.js","module.exports = require(\"buffer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"buffer\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 33\n// module chunks = 0","// var session = require('express-session');\n// var MySQLStore = require('express-mysql-session')(session);\n// import bodyParser from 'body-parser'\n\nmodule.exports = {\n    /*\n     ** Headers of the page\n     */\n    head: {\n        script: [{\n            src: 'https://www.huangchengdu.com/javascripts/screen.js'\n        }],\n        title: '黄成都的技术博客',\n        meta: [{\n                charset: 'utf-8'\n            },\n            {\n                name: 'viewport',\n                content: 'width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui'\n            },\n            {\n                hid: 'description',\n                name: 'description',\n                content: '黄成都的技术博客'\n            },\n            // /*优先使用 IE 最新版本和 Chrome  */\n            {\n                name: 'renderer',\n                content: 'webkit'\n            },\n            {\n                'http-equiv': 'X-UA-Compatible',\n                content: 'IE=edge'\n            },\n            /* iOS 设备 */\n            {\n                name: 'author',\n                content: '黄成都'\n            },\n            {\n                name: 'apple-mobile-web-app-title',\n                content: '黄成都的技术博客'\n            },\n            {\n                name: 'apple-mobile-web-app-capable',\n                content: 'yes'\n            },\n            {\n                name: 'apple-mobile-web-app-status-bar-style',\n                content: '#263238'\n            },\n            /*fullscreen and app mode*/\n            {\n                name: 'screen-orientation',\n                content: 'portrait'\n            },\n            {\n                name: 'x5-orientation',\n                content: 'portrait'\n            },\n            {\n                name: 'full-screen',\n                content: 'yes'\n            },\n            {\n                name: 'x5-fullscreen',\n                content: 'true'\n            },\n            {\n                name: 'browsermode',\n                content: 'application'\n            },\n            {\n                name: 'x5-page-mode',\n                content: 'app'\n            },\n            /*webkit*/\n            {\n                name: 'theme-color',\n                content: '#263238'\n            }\n        ],\n        link: [{\n            rel: 'icon',\n            type: 'image/x-icon',\n            href: '/img/favicon.ico'\n        }]\n    },\n    css: [{\n        src: '~assets/less/main.less',\n        lang: 'less'\n    }],\n    /*\n     ** Build configuration\n     */\n    build: {\n        vendor: ['axios', 'vue-notification'],\n        /*\n         ** Run ESLint on save\n         */\n        // extend(config, ctx) {\n        // \tif (ctx.dev && ctx.isClient) {\n        // \t\tconfig.module.rules.push({\n        // \t\t\tenforce: 'pre',\n        // \t\t\ttest: /\\.(js|vue)$/,\n        // \t\t\tloader: 'eslint-loader',\n        // \t\t\texclude: /(node_modules)/\n        // \t\t})\n        // \t}\n        // }\n    },\n    loading: {\n        // color: '#04acf7',\n        // height: '4px',\n        // failedColor: 'red'\n        // loading: '~/components/loading.vue'\n    },\n    //页面的过渡效果\n    transition: {\n        name: 'page'\n    },\n    //配置路由\n    router: {\n        middleware: 'adminAuth'\n    },\n    //插件\n    plugins: [{\n            src: '~plugins/axios'\n        },\n        {\n            src: '~plugins/vue-notification',\n            ssr: false\n        }\n    ],\n    serverMiddleware: [\n        // body-parser middleware\n        // bodyParser.json(),\n        // session middleware\n        // session({\n        //   secret: 'super-secret-key',\n        //   resave: false,\n        //   saveUninitialized: false,\n        //   cookie: { maxAge: 60000 }\n        // }),\n        // Api middleware\n        // We add /api/login & /api/logout routes\n        // '~/api'\n    ],\n    render: {\n        // bundleRenderer: {\n        //     cache: require('lru-cache')({\n        //         max: 1,\n        //         maxAge: 1000 * 60 * 0.1\n        //     })\n        // }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = {\"name\":\"juejin\",\"version\":\"1.0.0\",\"description\":\"Nuxt.js project\",\"author\":\"huangchengdu <394042583@qq.com>\",\"private\":true,\"config\":{\"nuxt\":{\"port\":\"5389\"}},\"scripts\":{\"dev\":\"cross-env NODE_ENV=development backpack dev\",\"build\":\"cross-env NODE_ENV=production nuxt build && backpack build\",\"start\":\"cross-env NODE_ENV=production pm2 start build/main.js\",\"generate\":\"cross-env NODE_ENV=production nuxt generate\",\"nuxt\":\"cross-env NODE_ENV=development nuxt\",\"nuxt-build\":\"cross-env NODE_ENV=production nuxt build\",\"nuxt-start\":\"cross-env NODE_ENV=production nuxt start\",\"lint\":\"cross-env NODE_ENV=development eslint --ext .js,.vue --ignore-path .gitignore .\",\"precommit\":\"cross-env NODE_ENV=development npm run lint\"},\"dependencies\":{\"axios\":\"^0.17.1\",\"backpack-core\":\"^0.4.3\",\"body-parser\":\"^1.18.2\",\"cookie-parser\":\"^1.4.3\",\"cross-env\":\"^5.1.1\",\"crypto-js\":\"^3.1.9-1\",\"express\":\"^4.16.2\",\"express-formidable\":\"^1.0.0\",\"express-mysql-session\":\"^1.2.3\",\"express-session\":\"^1.15.6\",\"express-winston\":\"^2.4.0\",\"jade\":\"^1.11.0\",\"less\":\"^2.7.3\",\"less-loader\":\"^4.0.5\",\"marked\":\"^0.3.7\",\"multer\":\"^1.3.0\",\"mysql\":\"^2.15.0\",\"nuxt\":\"^1.0.0-rc11\",\"sha1\":\"^1.1.1\",\"vue-notification\":\"^1.3.4\",\"winston\":\"^2.4.0\"},\"devDependencies\":{\"babel-eslint\":\"^7.2.3\",\"eslint\":\"^4.3.0\",\"eslint-config-standard\":\"^10.2.1\",\"eslint-loader\":\"^1.9.0\",\"eslint-plugin-html\":\"^3.1.1\",\"eslint-plugin-import\":\"^2.7.0\",\"eslint-plugin-node\":\"^5.1.1\",\"eslint-plugin-promise\":\"^3.5.0\",\"eslint-plugin-standard\":\"^3.0.1\",\"lru-cache\":\"^4.1.1\",\"xss\":\"^0.3.7\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./package.json\n// module id = 36\n// module chunks = 0","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 39\n// module chunks = 0"],"sourceRoot":""}